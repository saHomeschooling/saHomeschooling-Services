<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Dashboard · SA Homeschooling</title>
    <!-- Font Awesome 6 (free) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- shared dashboard CSS with custom palette -->
    <link rel="stylesheet" href="dashboard.css">
    <style>
        /* additional inline styles */
        .editable-field {
            transition: all 0.1s ease;
        }
        .edit-mode .profile-value {
            background: #fff9f0;
            border: 1.5px solid var(--accent);
            cursor: pointer;
            padding: 0.6rem 0.9rem;
            box-shadow: 0 0 0 3px rgba(224,43,88,0.1);
        }
        .edit-mode .profile-field label {
            color: var(--accent);
        }
        .hidden-file-input {
            display: none;
        }
        .photo-round img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            display: block;
        }
        .edit-mode select.profile-value,
        .edit-mode input.profile-value {
            appearance: none;
            background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23e02b58' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><polyline points='6 9 12 15 18 9'/></svg>");
            background-repeat: no-repeat;
            background-position: right 0.7rem center;
            background-size: 1rem;
            padding-right: 2rem;
        }
        .days-multi {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        .day-checkbox {
            display: flex;
            align-items: center;
            background: white;
            border: 1px solid #cbd5e1;
            border-radius: 30px;
            padding: 0.3rem 1rem;
            font-size: 0.85rem;
            font-weight: 500;
            color: #1f3a5f;
        }
        .day-checkbox input {
            margin-right: 0.3rem;
            accent-color: var(--accent);
        }
        .edit-mode .day-checkbox {
            border-color: var(--accent);
            background: #fff0f3;
        }
        .inline-flex-row {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            flex-wrap: wrap;
        }
        .radius-input {
            width: 80px;
            padding: 0.3rem;
            border: 1px solid #cbd5e1;
            border-radius: 30px;
            text-align: center;
        }
        .toggle-switch {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }
        .toggle-switch input {
            display: none;
        }
        .toggle-slider {
            width: 44px;
            height: 24px;
            background: #cbd5e1;
            border-radius: 40px;
            position: relative;
            transition: 0.2s;
        }
        .toggle-slider:before {
            content: "";
            position: absolute;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: 0.2s;
        }
        input:checked + .toggle-slider {
            background: var(--accent);
        }
        input:checked + .toggle-slider:before {
            left: 22px;
        }
        .social-links-preview {
            background: #f1f5f9;
            padding: 0.5rem 1rem;
            border-radius: 30px;
        }
        /* Tags styling */
        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            align-items: center;
            margin-top: 0.5rem;
        }
        .tag-item {
            background: var(--accent-2);
            color: white;
            padding: 0.3rem 1rem;
            border-radius: 30px;
            font-size: 0.85rem;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        .tag-item i {
            cursor: pointer;
            font-size: 0.8rem;
            opacity: 0.8;
        }
        .tag-item i:hover {
            opacity: 1;
        }
        .tag-input-wrapper {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            background: white;
            border: 1px solid #cbd5e1;
            border-radius: 30px;
            padding: 0.2rem 0.5rem 0.2rem 1rem;
        }
        .tag-input-wrapper input {
            border: none;
            outline: none;
            padding: 0.3rem 0;
            width: 120px;
            background: transparent;
        }
        .tag-input-wrapper button {
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 30px;
            padding: 0.3rem 1rem;
            cursor: pointer;
            font-size: 0.8rem;
        }
        .edit-mode .tag-input-wrapper input:disabled {
            background: #f1f5f9;
            cursor: not-allowed;
        }
        /* Qualifications styling */
        .qualification-item {
            background: rgba(224,43,88,0.02);
            border-radius: 20px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        /* Reviews section styling */
        .reviews-section {
            margin-top: 2rem;
            border-top: 2px dashed var(--accent-2);
            padding-top: 1.5rem;
        }
        .review-item {
            background: rgba(224,43,88,0.02);
            border-radius: 20px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        .rating-stars {
            color: #f5b342;
            letter-spacing: 2px;
            font-size: 1.2rem;
        }
        .badge-clearance {
            background: #10b981;
            color: white;
            padding: 0.2rem 1rem;
            border-radius: 30px;
            font-size: 0.8rem;
            display: inline-block;
        }
        /* Language multi-select styling */
        .language-select {
            width: 100%;
            min-height: 100px;
            border-radius: 16px;
            padding: 0.5rem;
            border: 1px solid #dee8f2;
            background: #f2f6fb;
        }
        .edit-mode .language-select {
            background: #fff9f0;
            border: 1.5px solid var(--accent);
        }
        .language-select option {
            padding: 0.3rem;
        }
    </style>
</head>
<body>
    <header class="top-header">
        <div class="logo-area">
            <div class="logo-short">SAH</div>
            <div class="trusted-text">
                Trusted Homeschooling Directory
                <span>SA Homeschooling</span>
            </div>
        </div>
        <div class="nav-links">
            <a href="#">Home</a>
            <a href="#">Find Providers</a>
            <a href="#">List Services</a>
            <a href="#">Join Directory</a>
            <a href="#">About</a>
            <a href="#" class="cta-nav">List Your Service</a>
        </div>
    </header>

    <div class="dash-wrapper">
        <div class="page-headline">
            <h1>My Provider Dashboard</h1>
            <p>Welcome back, Bright Minds Tutoring · <a href="#">switch to public view</a></p>
        </div>

        <!-- main client dashboard card -->
        <div class="card client-dash" id="clientDashboard">
            <div class="card-header">
                <i class="fas fa-user-circle"></i>
                <h2>Profile information</h2>
                <span class="badge" id="editModeBadge" style="cursor:pointer;" onclick="toggleEditMode()">
                    <i class="far fa-edit"></i>  activate edit mode
                </span>
            </div>

            <!-- photo row -->
            <div class="photo-placeholder">
                <div class="photo-round" onclick="document.getElementById('photoUpload').click();" style="cursor:pointer; overflow:hidden;">
                    <i class="fas fa-camera" id="photoIcon"></i>
                    <img id="photoImg" src="#" alt="" style="display:none; width:100%; height:100%; object-fit:cover;">
                </div>
                <div>
                    <button class="btn-edit" type="button" onclick="document.getElementById('photoUpload').click();"><i class="fas fa-pencil-alt"></i>  change photo / logo</button>
                    <p class="hint">Click to upload (JPG, PNG)</p>
                </div>
            </div>
            <input type="file" id="photoUpload" class="hidden-file-input" accept="image/*" onchange="handlePhotoUpload(event)">

            <!-- two column fields -->
            <div class="two-col">
                <div class="profile-field"><label>Full name / Business *</label><div class="profile-value" id="fieldBusiness">Bright Minds Tutoring</div></div>
                <div class="profile-field"><label>Email address *</label><div class="profile-value" id="fieldEmail">hello@brightminds.co.za</div></div>
                <div class="profile-field"><label>Account type *</label><div class="profile-value" id="fieldAccountType">Organization/Company</div></div>
                
                <!-- Years of Experience -->
                <div class="profile-field"><label>Years of Experience</label>
                    <div id="fieldYearsContainer">
                        <select id="fieldYears" class="profile-value" disabled>
                            <option value="0-1">0-1 Years</option>
                            <option value="1-3">1-3 Years</option>
                            <option value="3-5">3-5 Years</option>
                            <option value="5-10">5-10 Years</option>
                            <option value="10+" selected>10+ Years</option>
                        </select>
                    </div>
                </div>

                <!-- Languages spoken - now a multi-select with all 12 official languages -->
                <div class="profile-field"><label>Languages spoken *</label>
                    <select id="fieldLanguages" class="language-select" multiple size="4" disabled>
                        <option value="Afrikaans" selected>Afrikaans</option>
                        <option value="English" selected>English</option>
                        <option value="isiNdebele">isiNdebele</option>
                        <option value="isiXhosa" selected>isiXhosa</option>
                        <option value="isiZulu">isiZulu</option>
                        <option value="Sesotho">Sesotho</option>
                        <option value="Sesotho sa Leboa">Sesotho sa Leboa (Northern Sotho)</option>
                        <option value="Setswana">Setswana</option>
                        <option value="siSwati">siSwati</option>
                        <option value="Tshivenda">Tshivenda</option>
                        <option value="Xitsonga">Xitsonga</option>
                    </select>
                </div>

                <div class="profile-field"><label>Primary category *</label><div class="profile-value" id="fieldCategory">Tutor (Math & Science)</div></div>
            </div>

            <!-- TAGS SECTION -->
            <div class="profile-field"><label>Tags (e.g. mathematics, tutoring, therapy)</label>
                <div id="tagsContainer" class="tags-container">
                    <!-- Tags will be dynamically inserted here -->
                </div>
                <div class="tag-input-wrapper" id="tagInputWrapper">
                    <input type="text" id="newTagInput" placeholder="Add a tag..." disabled>
                    <button id="addTagBtn" disabled onclick="addNewTag()">Add</button>
                </div>
            </div>

            <!-- short bio -->
            <div class="profile-field"><label>Short bio *</label><div class="profile-value" id="fieldBio">We offer specialised Maths & Science tutoring for grades 8–12 with a creative curriculum approach. Small groups & individual support. Based in Johannesburg but available nationwide online. Certified educators with 10+ years experience.</div></div>

            <!-- QUALIFICATIONS & EXPERIENCE SECTION -->
            <div class="profile-field"><label style="font-size:1rem; margin-top:1rem;">Qualifications & Experience</label>
                <div class="qualification-item">
                    <div class="inline-group" style="margin-bottom:0.5rem;">
                        <div class="profile-field"><label>Certifications</label><div class="profile-value" id="fieldCertifications" contenteditable="false">PGCE, TEFL, Maths Specialist</div></div>
                        <div class="profile-field"><label>Degrees</label><div class="profile-value" id="fieldDegrees" contenteditable="false">BSc Mathematics, MEd (Educational Psychology)</div></div>
                    </div>
                    <div class="inline-group">
                        <div class="profile-field"><label>Professional memberships</label><div class="profile-value" id="fieldMemberships" contenteditable="false">SACE, SAALT, IEB Affiliate</div></div>
                        <div class="profile-field"><label>Background clearance</label>
                            <div id="fieldClearanceContainer">
                                <span class="badge-clearance" id="clearanceBadge"><i class="fas fa-check-circle"></i> Verified (2025)</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- service details -->
            <div class="inline-group">
                <div class="profile-field"><label>Service title *</label><div class="profile-value" id="fieldServiceTitle">Math & Science Mentor (Gr 8-12)</div></div>
                
                <!-- Age group -->
                <div class="profile-field"><label>Age group served</label>
                    <select id="fieldAgeGroup" class="profile-value" disabled>
                        <option value="5-7">5-7 years</option>
                        <option value="8-10">8-10 years</option>
                        <option value="11-13">11-13 years</option>
                        <option value="14-18" selected>14-18 years</option>
                    </select>
                </div>

                <!-- Mode of delivery -->
                <div class="profile-field"><label>Mode of delivery</label>
                    <select id="fieldMode" class="profile-value" disabled>
                        <option value="online">Online</option>
                        <option value="inperson">In Person</option>
                        <option value="hybrid" selected>Hybrid</option>
                    </select>
                </div>
            </div>

            <!-- Province + city (editable city) -->
            <div class="inline-group">
                <div class="profile-field"><label>Province</label>
                    <select id="fieldProvince" class="profile-value" disabled>
                        <option value="EC">Eastern Cape</option>
                        <option value="FS">Free State</option>
                        <option value="GP" selected>Gauteng</option>
                        <option value="KZN">KwaZulu-Natal</option>
                        <option value="LP">Limpopo</option>
                        <option value="MP">Mpumalanga</option>
                        <option value="NC">Northern Cape</option>
                        <option value="NW">North West</option>
                        <option value="WC">Western Cape</option>
                    </select>
                </div>
                <div class="profile-field"><label>City / Town</label>
                    <div class="profile-value" id="fieldCity" contenteditable="false">Johannesburg</div>
                </div>
            </div>

            <!-- Service area with conditional radius -->
            <div class="profile-field"><label>Service area *</label>
                <div class="inline-flex-row">
                    <select id="fieldServiceAreaType" class="profile-value" style="width:auto;" disabled>
                        <option value="local" selected>Local (specify radius)</option>
                        <option value="national">National</option>
                        <option value="online">Online only</option>
                    </select>
                    <span id="radiusContainer" style="display:inline-flex; align-items:center; gap:0.3rem;">
                        <input type="number" id="fieldRadius" class="radius-input" value="30" min="1" max="200" disabled> <span>km</span>
                    </span>
                </div>
                <div class="profile-value" id="fieldServiceAreaDisplay" style="margin-top:0.3rem; display:none;"></div>
            </div>

            <!-- Pricing model -->
            <div class="inline-group">
                <div class="profile-field"><label>Pricing model *</label>
                    <select id="fieldPricingModel" class="profile-value" disabled>
                        <option value="hourly" selected>Hourly</option>
                        <option value="package">Per package</option>
                        <option value="term">Per term</option>
                        <option value="custom">Custom quote</option>
                    </select>
                </div>
                <div class="profile-field"><label>Starting price (optional)</label><div class="profile-value" id="fieldStartingPrice">R280/hr | R1500/5 sessions</div></div>
            </div>

            <!-- Availability days -->
            <div class="profile-field"><label>Availability — Days</label>
                <div id="fieldAvailabilityDays" class="days-multi">
                    <label class="day-checkbox"><input type="checkbox" value="Mon" checked disabled> Mon</label>
                    <label class="day-checkbox"><input type="checkbox" value="Tue" checked disabled> Tue</label>
                    <label class="day-checkbox"><input type="checkbox" value="Wed" checked disabled> Wed</label>
                    <label class="day-checkbox"><input type="checkbox" value="Thu" checked disabled> Thu</label>
                    <label class="day-checkbox"><input type="checkbox" value="Fri" checked disabled> Fri</label>
                    <label class="day-checkbox"><input type="checkbox" value="Sat" checked disabled> Sat</label>
                    <label class="day-checkbox"><input type="checkbox" value="Sun" disabled> Sun</label>
                </div>
                <div class="profile-value" id="fieldAvailabilityNotes" style="margin-top:0.5rem;">14:00-18:00 weekdays, Sat 09:00-13:00</div>
            </div>

            <!-- Contact & social with public toggle -->
            <div class="contact-block">
                <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap;">
                    <span><i class="fas fa-address-card"></i> <strong>Primary contact:</strong></span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="publicToggle" checked disabled>
                        <span class="toggle-slider"></span>
                        <span>Display publicly <i class="fas fa-globe"></i></span>
                    </label>
                </div>
                <div style="margin-top:0.5rem;">
                    <span id="fieldContactName">Maria van der Merwe</span> · 
                    <span id="fieldPhone">+27 82 555 1234</span> · 
                    <span id="fieldContactEmail">maria@brightminds.co.za</span>
                </div>
                <!-- Social links preview (only visible if toggle on) -->
                <div id="socialPreview" class="social-links-preview" style="margin-top:0.8rem;">
                    <span id="fieldSocial"><i class="fab fa-facebook"></i> <i class="fab fa-instagram"></i> @brightminds_tutoring  |  www.brightminds.co.za  |  FB, IG, LinkedIn</span>
                </div>
            </div>

            <!-- listing plan -->
            <div style="display: flex; align-items: center; justify-content: space-between; margin: 1.5rem 0 0.5rem;">
                <div><span class="plan-badge"><i class="fas fa-crown" style="color:#f7d45a;"></i>  Professional Listing (paid)</span></div>
                <div><i class="fas fa-check-circle" style="color:var(--success);"></i> listing is public</div>
            </div>

            <!-- REVIEWS & TESTIMONIALS SECTION - AT THE BOTTOM -->
            <div class="reviews-section">
                <div class="profile-field"><label style="font-size:1.2rem; color:var(--accent);">Reviews & Testimonials (Paid tiers)</label></div>
                <div class="review-item" id="reviewsContainer">
                    <div class="rating-stars">★★★★★</div>
                    <div class="profile-value" id="fieldReview1" contenteditable="false" style="margin:0.5rem 0;">"Bright Minds transformed my daughter's confidence in maths. Highly recommend!" - Sarah J.</div>
                    <div class="rating-stars">★★★★☆</div>
                    <div class="profile-value" id="fieldReview2" contenteditable="false" style="margin:0.5rem 0;">"Excellent science tutor, very patient and knowledgeable." - Thabo M.</div>
                    <div class="profile-value" id="fieldReview3" contenteditable="false" style="margin:0.5rem 0; font-style:italic;">Average rating: 4.8/5 (based on 12 reviews)</div>
                </div>
            </div>

            <hr>
            <div style="display: flex; gap: 2rem; justify-content: flex-end; align-items: center;">
                <span style="color:#4b5563;"><i class="far fa-clock"></i> last edited today</span>
                <div id="editControls" style="display: none; gap: 1rem;">
                    <button class="btn-edit" id="saveBtn" style="background: var(--accent); color: white; border: none;" onclick="saveChanges()"><i class="fas fa-save"></i>  save changes</button>
                    <button class="btn-edit" id="cancelBtn" onclick="cancelEdit()">cancel</button>
                </div>
                <span id="editModeHint" style="color: #64748b;"><i class="far fa-eye"></i> view only</span>
            </div>
        </div>

        <div class="signup-mini">
            <p><i class="fas fa-database"></i> <strong>Updated:</strong> Languages spoken now uses a multi-select with all 12 official South African languages.</p>
        </div>
    </div>

    <div class="footer-note">SA Homeschooling Directory · fully editable dashboard</div>

    <script>
        // State
        let editModeActive = false;
        let originalValues = {};

        // Tags array
        let tags = ['mathematics', 'tutoring', 'grade 8-12']; // default tags

        // Text fields (contenteditable)
        const textFields = [
            'fieldBusiness','fieldEmail','fieldAccountType','fieldCategory',
            'fieldBio','fieldServiceTitle','fieldStartingPrice','fieldAvailabilityNotes',
            'fieldContactName','fieldPhone','fieldContactEmail','fieldSocial','fieldCity',
            'fieldCertifications','fieldDegrees','fieldMemberships','fieldReview1','fieldReview2','fieldReview3'
        ];

        // Select elements (including multi-select language)
        const selectIds = ['fieldYears','fieldAgeGroup','fieldMode','fieldProvince','fieldPricingModel','fieldServiceAreaType'];
        // Language multi-select is handled separately
        const languageSelect = document.getElementById('fieldLanguages');
        
        // Checkboxes (days)
        const dayCheckboxes = document.querySelectorAll('#fieldAvailabilityDays input[type=checkbox]');
        // Public toggle
        const publicToggle = document.getElementById('publicToggle');
        const socialPreview = document.getElementById('socialPreview');
        // Radius input
        const radiusInput = document.getElementById('fieldRadius');
        const serviceAreaType = document.getElementById('fieldServiceAreaType');

        // Tags elements
        const tagsContainer = document.getElementById('tagsContainer');
        const newTagInput = document.getElementById('newTagInput');
        const addTagBtn = document.getElementById('addTagBtn');

        // Render tags
        function renderTags() {
            tagsContainer.innerHTML = '';
            tags.forEach((tag, index) => {
                const tagEl = document.createElement('span');
                tagEl.className = 'tag-item';
                tagEl.innerHTML = `${tag} <i class="fas fa-times" onclick="removeTag(${index})" style="cursor:pointer;"></i>`;
                tagsContainer.appendChild(tagEl);
            });
        }

        // Add new tag
        function addNewTag() {
            if (!editModeActive) return;
            const input = document.getElementById('newTagInput');
            const newTag = input.value.trim();
            if (newTag && !tags.includes(newTag)) {
                tags.push(newTag);
                renderTags();
                input.value = '';
            }
        }

        // Remove tag
        function removeTag(index) {
            if (!editModeActive) return;
            tags.splice(index, 1);
            renderTags();
        }

        // Helper to get selected languages as comma string
        function getSelectedLanguages() {
            const selected = [];
            for (let option of languageSelect.options) {
                if (option.selected) selected.push(option.value);
            }
            return selected.join(', ');
        }

        // Helper to set selected languages from comma string
        function setSelectedLanguages(langString) {
            const langArray = langString.split(',').map(s => s.trim());
            for (let option of languageSelect.options) {
                option.selected = langArray.includes(option.value);
            }
        }

        // Show/hide radius based on service area type
        function updateRadiusVisibility() {
            const radiusContainer = document.getElementById('radiusContainer');
            if (serviceAreaType.value === 'local') {
                radiusContainer.style.display = 'inline-flex';
            } else {
                radiusContainer.style.display = 'none';
            }
        }
        serviceAreaType.addEventListener('change', updateRadiusVisibility);

        // Toggle social preview based on public toggle
        function updateSocialVisibility() {
            if (publicToggle.checked) {
                socialPreview.style.display = 'block';
            } else {
                socialPreview.style.display = 'none';
            }
        }
        publicToggle.addEventListener('change', updateSocialVisibility);

        function toggleEditMode() {
            const badge = document.getElementById('editModeBadge');
            const editControls = document.getElementById('editControls');
            const editHint = document.getElementById('editModeHint');
            const dashboard = document.getElementById('clientDashboard');

            if (!editModeActive) {
                // store original values
                textFields.forEach(id => {
                    const el = document.getElementById(id);
                    if (el) originalValues[id] = el.innerText;
                });
                selectIds.forEach(id => {
                    const sel = document.getElementById(id);
                    if (sel) originalValues[id] = sel.value;
                });
                // Store language selections
                originalValues.languages = getSelectedLanguages();
                
                originalValues.days = [];
                dayCheckboxes.forEach(cb => {
                    originalValues.days.push({ value: cb.value, checked: cb.checked });
                });
                originalValues.publicToggle = publicToggle.checked;
                originalValues.radius = radiusInput.value;
                originalValues.tags = [...tags];

                // enable editing
                textFields.forEach(id => {
                    document.getElementById(id).setAttribute('contenteditable', 'true');
                });
                selectIds.forEach(id => {
                    document.getElementById(id).disabled = false;
                });
                languageSelect.disabled = false;
                dayCheckboxes.forEach(cb => cb.disabled = false);
                publicToggle.disabled = false;
                radiusInput.disabled = false;
                newTagInput.disabled = false;
                addTagBtn.disabled = false;

                dashboard.classList.add('edit-mode');
                badge.innerHTML = '<i class="fas fa-pencil-alt"></i>  edit mode active';
                editControls.style.display = 'flex';
                editHint.style.display = 'none';
                editModeActive = true;
                updateRadiusVisibility();
                renderTags();
            } else {
                cancelEdit();
            }
        }

        function cancelEdit() {
            const dashboard = document.getElementById('clientDashboard');
            const badge = document.getElementById('editModeBadge');
            const editControls = document.getElementById('editControls');
            const editHint = document.getElementById('editModeHint');

            // revert text fields
            textFields.forEach(id => {
                const el = document.getElementById(id);
                if (el && originalValues[id] !== undefined) {
                    el.innerText = originalValues[id];
                }
                el.setAttribute('contenteditable', 'false');
            });

            selectIds.forEach(id => {
                const sel = document.getElementById(id);
                if (sel && originalValues[id] !== undefined) {
                    sel.value = originalValues[id];
                }
                sel.disabled = true;
            });

            // revert language select
            if (originalValues.languages) {
                setSelectedLanguages(originalValues.languages);
            }
            languageSelect.disabled = true;

            dayCheckboxes.forEach(cb => {
                const orig = originalValues.days?.find(d => d.value === cb.value);
                if (orig) cb.checked = orig.checked;
                cb.disabled = true;
            });

            if (originalValues.publicToggle !== undefined) publicToggle.checked = originalValues.publicToggle;
            publicToggle.disabled = true;

            if (originalValues.radius !== undefined) radiusInput.value = originalValues.radius;
            radiusInput.disabled = true;

            // revert tags
            tags = originalValues.tags ? [...originalValues.tags] : [];
            renderTags();
            newTagInput.disabled = true;
            addTagBtn.disabled = true;

            dashboard.classList.remove('edit-mode');
            badge.innerHTML = '<i class="far fa-edit"></i>  activate edit mode';
            editControls.style.display = 'none';
            editHint.style.display = 'inline';
            editModeActive = false;

            updateSocialVisibility();
            updateRadiusVisibility();
        }

        function saveChanges() {
            // update original values
            textFields.forEach(id => {
                originalValues[id] = document.getElementById(id).innerText;
            });
            selectIds.forEach(id => {
                originalValues[id] = document.getElementById(id).value;
            });
            originalValues.languages = getSelectedLanguages();
            
            originalValues.days = [];
            dayCheckboxes.forEach(cb => {
                originalValues.days.push({ value: cb.value, checked: cb.checked });
            });
            originalValues.publicToggle = publicToggle.checked;
            originalValues.radius = radiusInput.value;
            originalValues.tags = [...tags];

            // exit edit mode (disable all)
            const dashboard = document.getElementById('clientDashboard');
            const badge = document.getElementById('editModeBadge');
            const editControls = document.getElementById('editControls');
            const editHint = document.getElementById('editModeHint');

            textFields.forEach(id => {
                document.getElementById(id).setAttribute('contenteditable', 'false');
            });
            selectIds.forEach(id => {
                document.getElementById(id).disabled = true;
            });
            languageSelect.disabled = true;
            dayCheckboxes.forEach(cb => cb.disabled = true);
            publicToggle.disabled = true;
            radiusInput.disabled = true;
            newTagInput.disabled = true;
            addTagBtn.disabled = true;

            dashboard.classList.remove('edit-mode');
            badge.innerHTML = '<i class="far fa-edit"></i>  activate edit mode';
            editControls.style.display = 'none';
            editHint.style.display = 'inline';
            editModeActive = false;

            updateSocialVisibility();
            updateRadiusVisibility();

            alert('Changes saved (demo).');
        }

        function handlePhotoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.getElementById('photoImg');
                    const icon = document.getElementById('photoIcon');
                    img.src = e.target.result;
                    img.style.display = 'block';
                    icon.style.display = 'none';
                }
                reader.readAsDataURL(file);
            }
        }

        window.onload = function() {
            textFields.forEach(id => {
                const el = document.getElementById(id);
                if (el) originalValues[id] = el.innerText;
            });
            selectIds.forEach(id => {
                const sel = document.getElementById(id);
                if (sel) originalValues[id] = sel.value;
            });
            originalValues.languages = getSelectedLanguages();
            
            originalValues.days = [];
            dayCheckboxes.forEach(cb => {
                originalValues.days.push({ value: cb.value, checked: cb.checked });
            });
            originalValues.publicToggle = publicToggle.checked;
            originalValues.radius = radiusInput.value;
            originalValues.tags = [...tags];

            renderTags();
            updateSocialVisibility();
            updateRadiusVisibility();
        };
    </script>
</body>
</html>
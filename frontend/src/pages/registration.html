<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SA Homeschooling – Onboarding</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;0,800;0,900;1,700&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    /* ----- consistent theme (homepage tokens) ----- */
    :root {
      --accent:        #c0234a;
      --accent-dark:   #96183a;
      --accent-light:  #f5d0d8;
      --dark:          #111111;
      --mid:           #3a1a22;
      --muted:         #6b6b6b;
      --light-bg:      #f8f4f5;
      --white:         #ffffff;
      --border:        rgba(0,0,0,0.09);
      --shadow-sm:     0 1px 4px rgba(0,0,0,0.07);
      --shadow-md:     0 4px 20px rgba(0,0,0,0.10);
      --shadow-lg:     0 12px 48px rgba(0,0,0,0.14);
      --radius:        8px;
      --radius-lg:     12px;
      --header-h:      68px;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      font-family: 'DM Sans', sans-serif;
      background: var(--white);
      color: var(--dark);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      background: var(--light-bg);
    }
    a { color: inherit; text-decoration: none; }
    button { cursor: pointer; font-family: inherit; border: none; background: none; }
    .container { max-width: 1280px; margin: 0 auto; padding: 0 32px; }

    /* ----- header (exact copy from home) ----- */
    header {
      position: sticky; top: 0; z-index: 1000;
      height: var(--header-h);
      background: var(--accent);
    }
    .nav-inner {
      height: 100%;
      display: flex; justify-content: space-between; align-items: center;
    }
    .brand { display: flex; align-items: center; gap: 12px; }
    .brand-divider { width: 2px; height: 30px; background: rgba(255,255,255,0.5); border-radius: 1px; }
    .brand-text { display: flex; flex-direction: column; line-height: 1.15; }
    .brand-name {
      font-family: 'Playfair Display', serif;
      font-weight: 800; font-size: 1rem; color: #fff; letter-spacing: 0.2px;
    }
    .brand-tag { font-size: 0.66rem; color: rgba(255,255,255,0.65); font-weight: 500; letter-spacing: 0.5px; }

    .nav-links { display: flex; align-items: center; gap: 2px; }
    .nav-links a {
      padding: 8px 14px; border-radius: 5px;
      font-weight: 600; font-size: 0.85rem;
      color: rgba(255,255,255,0.85); transition: all 0.15s;
    }
    .nav-links a:hover { color: #fff; background: rgba(255,255,255,0.1); }

    .nav-ctas { display: flex; align-items: center; gap: 8px; }
    .btn-ghost-nav {
      padding: 7px 16px; border-radius: 5px;
      border: 1.5px solid rgba(255,255,255,0.45);
      background: transparent; color: #fff;
      font-weight: 600; font-size: 0.85rem; transition: all 0.15s;
    }
    .btn-ghost-nav:hover { border-color: #fff; background: rgba(255,255,255,0.1); }
    .btn-solid-nav {
      padding: 7px 18px; border-radius: 5px;
      background: #fff; color: var(--accent);
      font-weight: 700; font-size: 0.85rem;
      border: none; transition: all 0.15s;
    }
    .btn-solid-nav:hover { background: var(--accent-light); }

    /* ----- onboarding lead ----- */
    .onboarding-lead {
      background: linear-gradient(145deg, #1e0a12 0%, #2c111f 100%);
      padding: 42px 0 24px;
      border-bottom: 4px solid var(--accent);
    }
    .onboarding-lead h1 {
      font-family: 'Playfair Display', serif;
      font-size: clamp(1.8rem,4vw,2.8rem);
      font-weight: 900;
      color: #fff;
      margin-bottom: 8px;
    }
    .step-indicator {
      display: flex;
      align-items: center;
      gap: 12px;
      color: rgba(255,255,255,0.6);
      font-weight: 500;
    }
    .step-indicator .step-progress {
      background: rgba(255,255,255,0.15);
      border-radius: 100px;
      height: 8px;
      flex: 1;
      max-width: 260px;
    }
    .step-progress-fill {
      width: 14%;
      height: 8px;
      background: var(--accent);
      border-radius: 100px;
    }
    .step-number {
      background: rgba(255,255,255,0.1);
      padding: 5px 14px;
      border-radius: 40px;
      font-size: 0.8rem;
      font-weight: 600;
      letter-spacing: 0.5px;
      color: #fff;
    }

    /* ----- form panel (card) -- now 80% width with 10% margins ----- */
    .form-panel {
      background: var(--white);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-lg);
      max-width: 1280px;
      width: 80%;
      margin: 50px auto 70px;
      padding: 48px 56px;  /* increased padding for larger feel */
      border: 1px solid var(--border);
    }
    .step-title {
      font-family: 'Playfair Display', serif;
      font-size: 2.2rem;    /* larger title */
      font-weight: 800;
      color: var(--dark);
      margin-bottom: 12px;
    }
    .step-desc {
      color: var(--muted);
      font-size: 1.1rem;     /* larger description */
      border-bottom: 1px solid var(--border);
      padding-bottom: 22px;
      margin-bottom: 32px;
    }

    /* ----- forms – enlarged inputs & labels ----- */
    .form-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 28px 32px;        /* more breathing room */
    }
    .full-width { grid-column: span 2; }
    .field {
      display: flex;
      flex-direction: column;
      gap: 8px;              /* increased gap */
    }
    .field label {
      font-weight: 600;
      font-size: 0.9rem;      /* larger label */
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--mid);
    }
    .field label i { color: var(--accent); width: 18px; font-size: 1rem; }
    .field input, .field select, .field textarea {
      width: 100%;
      padding: 16px 18px;      /* much larger padding */
      border: 1.5px solid var(--border);
      border-radius: var(--radius);
      font-family: 'DM Sans', sans-serif;
      font-size: 1.1rem;       /* larger input text */
      color: var(--dark);
      background: #fff;
      outline: none;
      transition: border 0.15s, box-shadow 0.15s;
    }
    .field input:focus, .field select:focus, .field textarea:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(192,35,74,0.1);
    }
    .field input[type="file"] { padding: 12px 14px; background: #fafafa; font-size: 1rem; }

    /* password eye */
    .password-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }
    .password-wrapper input {
      flex: 1;
      padding-right: 50px;
    }
    .toggle-pw {
      position: absolute;
      right: 16px;
      background: none;
      border: none;
      color: var(--muted);
      font-size: 1.2rem;
      cursor: pointer;
      padding: 0 6px;
    }
    .toggle-pw:hover { color: var(--accent); }

    .hint {
      font-size: 0.85rem;      /* slightly larger hint */
      color: var(--muted);
    }
    .checkbox-group, .multi-select {
      display: flex;
      flex-wrap: wrap;
      gap: 16px 28px;          /* increased gap */
      background: #fbfbfb;
      padding: 16px 20px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
    }
    .checkbox-group label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 1.1rem;       /* larger checkbox text */
      font-weight: 400;
      text-transform: none;
      color: var(--dark);
      white-space: nowrap;
    }
    .checkbox-group input[type="checkbox"], 
    .checkbox-group input[type="radio"] {
      width: 20px;              /* bigger checkboxes */
      height: 20px;
      accent-color: var(--accent);
      flex-shrink: 0;
    }
    @media (max-width: 500px) {
      .checkbox-group label { white-space: normal; }
    }

    /* inline other language field */
    .other-language-row {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 10px;
    }
    .other-language-row input {
      flex: 1;
      padding: 14px 16px;      /* larger */
      border: 1.5px solid var(--border);
      border-radius: var(--radius);
      font-size: 1.1rem;
    }

    .inline-row {
      display: flex;
      flex-wrap: wrap;
      gap: 18px;
      align-items: center;
    }
    .inline-row .field { flex: 1 1 160px; }

    /* navigation buttons - larger */
    .form-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 48px;
      gap: 20px;
    }
    .btn-prev, .btn-next, .btn-submit {
      padding: 18px 40px;       /* much larger buttons */
      border-radius: var(--radius);
      font-weight: 700;
      font-size: 1.1rem;
      transition: all 0.15s;
      border: none;
    }
    .btn-prev {
      background: #eaeef2;
      color: var(--dark);
      border: 1px solid var(--border);
    }
    .btn-prev:hover { background: #dde2e6; color: #000; }
    .btn-next, .btn-submit {
      background: var(--accent);
      color: #fff;
      box-shadow: var(--shadow-sm);
    }
    .btn-next:hover, .btn-submit:hover { background: var(--accent-dark); }
    .btn-submit { background: #0f7b6b; }
    .btn-submit:hover { background: #0b6356; }

    /* validation alert */
    .validation-alert {
      background: #fee9e9;
      border-left: 5px solid #c0234a;
      padding: 18px 22px;       /* larger alert */
      border-radius: var(--radius);
      margin-bottom: 32px;
      display: flex;
      align-items: center;
      gap: 14px;
      font-weight: 600;
      color: #a01b3a;
      font-size: 1rem;
    }
    .validation-alert i { font-size: 1.3rem; }

    /* toast */
    .toast {
      position: fixed; bottom: 22px; right: 22px;
      background: var(--dark); color: #fff;
      padding: 14px 22px; border-radius: var(--radius);
      font-size: 1rem; font-weight: 600;
      box-shadow: var(--shadow-lg);
      transform: translateY(60px); opacity: 0;
      transition: all 0.26s; z-index: 9999;
      display: flex; align-items: center; gap: 10px;
    }
    .toast.show { transform: translateY(0); opacity: 1; }
    .toast i { color: #22c55e; font-size: 1.2rem; }

    /* terms link */
    .terms-checkbox {
      display: flex;
      align-items: center;
      gap: 12px;
      background: #fbfbfb;
      padding: 16px 22px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
    }
    .terms-checkbox input {
      width: 22px;
      height: 22px;
      accent-color: var(--accent);
      margin: 0;
    }
    .terms-checkbox label {
      font-size: 1.1rem;
      text-transform: none;
      font-weight: 500;
      color: var(--dark);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .terms-link {
      color: var(--accent);
      font-weight: 600;
      text-decoration: underline;
      font-size: 1.1rem;
    }
    .terms-link:hover { color: var(--accent-dark); }

    /* ===== FOOTER STYLES (exactly as provided, unchanged) ===== */
    .sah-footer{
      background:#0e0e0e;
      color:rgba(255,255,255,.55);
      padding:60px 0 32px;
      font-family:'DM Sans',system-ui,sans-serif;
      font-size:.875rem;
      line-height:1.6
    }
    .sah-footer .container{
      max-width:1280px;
      margin:0 auto;
      padding:0 32px
    }
    .sah-footer-grid{
      display:grid;
      grid-template-columns:2fr 1fr 1fr 1fr;
      gap:48px;
      margin-bottom:44px
    }
    .sah-footer-logo{
      font-family:'Playfair Display',Georgia,serif;
      font-size:1.05rem;
      font-weight:800;
      color:#fff;
      display:block;
      margin-bottom:12px
    }
    .sah-footer-brand p{
      font-size:.85rem;
      line-height:1.75;
      max-width:260px;
      color:rgba(255,255,255,.55)
    }
    .sah-footer-newsletter{
      display:flex;
      margin-top:20px;
      border-radius:6px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.1);
      max-width:280px
    }
    .sah-footer-newsletter input{
      flex:1;
      padding:10px 13px;
      background:rgba(255,255,255,.06);
      border:none;
      color:#fff;
      font-family:inherit;
      font-size:.82rem;
      outline:none
    }
    .sah-footer-newsletter input::placeholder{
      color:rgba(255,255,255,.35)
    }
    .sah-footer-newsletter button{
      padding:10px 14px;
      background:var(--accent,#e02b58);
      color:#fff;
      border:none;
      font-family:inherit;
      font-weight:700;
      font-size:.8rem;
      cursor:pointer;
      transition:background .15s;
      white-space:nowrap
    }
    .sah-footer-newsletter button:hover{
      background:var(--accent-dark,#b01034)
    }
    .sah-footer-col h4{
      font-size:.68rem;
      font-weight:700;
      text-transform:uppercase;
      letter-spacing:2px;
      color:rgba(255,255,255,.4);
      margin-bottom:14px
    }
    .sah-footer-col ul{
      list-style:none;
      display:flex;
      flex-direction:column;
      gap:9px;
      padding:0;
      margin:0
    }
    .sah-footer-col ul li a{
      color:rgba(255,255,255,.55);
      text-decoration:none;
      font-size:.875rem;
      transition:color .15s
    }
    .sah-footer-col ul li a:hover{
      color:#fff
    }
    .sah-footer-trust{
      display:flex;
      gap:16px;
      align-items:center;
      padding:16px 0;
      margin-bottom:20px;
      border-top:1px solid rgba(255,255,255,.07);
      flex-wrap:wrap
    }
    .sah-footer-trust-item{
      display:flex;
      align-items:center;
      gap:7px;
      font-size:.78rem;
      color:rgba(255,255,255,.45)
    }
    .sah-footer-trust-item i{
      color:var(--accent,#e02b58);
      font-size:.82rem
    }
    .sah-footer-bottom{
      border-top:1px solid rgba(255,255,255,.07);
      padding-top:22px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:16px;
      flex-wrap:wrap
    }
    .sah-footer-bottom p{
      font-size:.8rem;
      color:rgba(255,255,255,.35)
    }
    .sah-footer-bottom-links{
      display:flex;
      gap:20px;
      font-size:.8rem
    }
    .sah-footer-bottom-links a{
      color:rgba(255,255,255,.4);
      text-decoration:none;
      transition:color .15s
    }
    .sah-footer-bottom-links a:hover{
      color:#fff
    }
    .sah-footer-socials{
      display:flex;
      gap:8px
    }
    .sah-footer-soc{
      width:34px;
      height:34px;
      border-radius:5px;
      background:rgba(255,255,255,.07);
      display:flex;
      align-items:center;
      justify-content:center;
      color:rgba(255,255,255,.45);
      font-size:.84rem;
      text-decoration:none;
      transition:all .15s
    }
    .sah-footer-soc:hover{
      background:var(--accent,#e02b58);
      color:#fff
    }
    @media(max-width:1024px){
      .sah-footer-grid{
        grid-template-columns:1fr 1fr;
        gap:32px
      }
    }
    @media(max-width:640px){
      .sah-footer{
        padding:44px 0 24px
      }
      .sah-footer .container{
        padding:0 20px
      }
      .sah-footer-grid{
        grid-template-columns:1fr;
        gap:28px
      }
      .sah-footer-bottom{
        flex-direction:column;
        align-items:flex-start;
        gap:12px
      }
      .sah-footer-bottom-links{
        flex-wrap:wrap;
        gap:12px
      }
    }

    /* responsive adjustments for smaller screens */
    @media (max-width: 720px) {
      .form-panel {
        width: 90%;            /* more width on mobile but still comfortable */
        padding: 28px 22px;
      }
      .form-grid { grid-template-columns: 1fr; }
      .full-width { grid-column: span 1; }
      .step-title { font-size: 1.8rem; }
      .btn-prev, .btn-next, .btn-submit { padding: 14px 24px; font-size: 1rem; }
    }
    @media (max-width: 480px) {
      .container { padding: 0 16px; }
      .form-panel { width: 94%; padding: 20px 16px; }
    }
  </style>
</head>
<body>
  <header>
    <div class="container nav-inner">
      <a href="#" class="brand">
        <div class="brand-divider"></div>
        <div class="brand-text">
          <span class="brand-name">SA Homeschooling</span>
          <span class="brand-tag">Education Services</span>
        </div>
      </a>
      <nav class="nav-links">
        <a href="#providers">Find Services</a>
        <a href="#how">How It Works</a>
        <a href="#list">List a Service</a>
        <a href="https://sahomeschooling.com" target="_blank">Magazine <i class="fas fa-arrow-up-right-from-square" style="font-size:0.65rem;"></i></a>
      </nav>
      <div class="nav-ctas">
        <a href="../pages/Login.html" class="btn-ghost-nav">Log In</a>
        <a href="../pages/registration.html" class="btn-solid-nav">Register</a>
      </div>
    </div>
  </header>

  <section class="onboarding-lead">
    <div class="container">
      <h1>Become a trusted provider</h1>
      <div class="step-indicator">
        <span class="step-number" id="stepCounter">Step 1 / 7</span>
        <div class="step-progress"><div class="step-progress-fill" id="stepProgressFill" style="width: 14%;"></div></div>
      </div>
    </div>
  </section>

  <!-- main form panel - now 80% width with auto margins -->
  <div class="form-panel" id="formPanel">
    <div id="stepContainer"></div>
    <div id="validationAlert" class="validation-alert" style="display: none;"><i class="fas fa-exclamation-triangle"></i> <span id="alertMsg"></span></div>
    <div class="form-nav" id="formNav"></div>
  </div>

  <!-- ===== FOOTER (exactly as provided, unchanged) ===== -->
  <footer class="sah-footer">
    <div class="container">

      <!-- Main link grid -->
      <div class="sah-footer-grid">

        <!-- Brand + newsletter -->
        <div class="sah-footer-brand">
          <span class="sah-footer-logo">SA Homeschooling Directory</span>
          <p>
            Connecting South African homeschooling families with verified tutors,
            therapists, curriculum providers and education specialists nationwide.
          </p>
          <div class="sah-footer-newsletter">
            <input type="email" placeholder="Subscribe to newsletter…" aria-label="Email address">
            <button type="button">Subscribe</button>
          </div>
        </div>

        <!-- For families -->
        <div class="sah-footer-col">
          <h4>For Families</h4>
          <ul>
            <li><a href="../homePage.html#providers">Find a Tutor</a></li>
            <li><a href="../homePage.html#providers">Browse Curriculum</a></li>
            <li><a href="../homePage.html#providers">Therapists</a></li>
            <li><a href="../homePage.html#providers">Online Schools</a></li>
            <li><a href="../homePage.html#providers">Consultants</a></li>
            <li><a href="../homePage.html#providers">Enrichment</a></li>
          </ul>
        </div>

        <!-- For providers -->
        <div class="sah-footer-col">
          <h4>For Providers</h4>
          <ul>
            <li><a href="../homePage.html#list">List a Service</a></li>
            <li><a href="../homePage.html#list">Pricing Plans</a></li>
            <li><a href="../auth/Login.html">Provider Login</a></li>
            <li><a href="#">Verification Process</a></li>
            <li><a href="#">Provider Resources</a></li>
          </ul>
        </div>

        <!-- Magazine + legal -->
        <div class="sah-footer-col">
          <h4>SA Homeschooling</h4>
          <ul>
            <li><a href="https://sahomeschooling.com" target="_blank" rel="noopener">Magazine</a></li>
            <li><a href="#">About the Directory</a></li>
            <li><a href="#">Contact Us</a></li>
            <li><a href="#">Privacy Policy</a></li>
            <li><a href="#">Terms of Service</a></li>
          </ul>
        </div>

      </div><!-- /sah-footer-grid -->

      <!-- Trust strip -->
      <div class="sah-footer-trust">
        <div class="sah-footer-trust-item">
          <i class="fas fa-shield-alt"></i> All providers manually verified
        </div>
        <div class="sah-footer-trust-item">
          <i class="fas fa-lock"></i> Secure &amp; private enquiries
        </div>
        <div class="sah-footer-trust-item">
          <i class="fas fa-star"></i> 4.9 average provider rating
        </div>
        <div class="sah-footer-trust-item">
          <i class="fas fa-map-marker-alt"></i> All 9 provinces covered
        </div>
      </div>

      <!-- Bottom bar -->
      <div class="sah-footer-bottom">
        <p>© 2025 SA Homeschooling Directory. A publication of SA Homeschooling Magazine. All rights reserved.</p>

        <div class="sah-footer-bottom-links">
          <a href="#">Privacy</a>
          <a href="#">Terms</a>
          <a href="#">Cookies</a>
          <a href="#">Sitemap</a>
        </div>

        <div class="sah-footer-socials">
          <a href="#" class="sah-footer-soc" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
          <a href="#" class="sah-footer-soc" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
          <a href="#" class="sah-footer-soc" aria-label="Pinterest"><i class="fab fa-pinterest-p"></i></a>
          <a href="#" class="sah-footer-soc" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
        </div>
      </div>

    </div>
  </footer>

  <div class="toast" id="toast"><i class="fas fa-check-circle"></i> <span id="toastMsg"></span></div>

  <script>
    (function() {
      // ---------- step definitions with all 7 steps preserved, only order changed ----------
      const steps = [
        { // NEW STEP 1: Choose Your Listing Plan (formerly step 7)
          fields: [
            { type: 'radio-group', label: 'Select a plan', name: 'listingPlan', options: [
              'Free Listing – basic profile',
              'Professional Listing – R149/month (full contact, direct enquiries)',
              'Featured Partner – R399/month (homepage placement, analytics)'
            ], required: true, col: 'full', default: 'Free Listing – basic profile' },
            { type: 'terms-check', label: 'I agree to the Terms and Community Guidelines', name: 'terms', required: true, col: 'full' }
          ]
        },
        { // STEP 2: Account Setup (formerly step 1)
          fields: [
            { type: 'text', label: 'Full Name / Business Name', name: 'fullName', required: true, col: 'full', placeholder: 'e.g. Thando Mkhize or Bright Minds Learning' },
            { type: 'email', label: 'Email Address', name: 'email', required: true, col: 'half', placeholder: 'name@example.com' },
            { type: 'password', label: 'Password', name: 'password', required: true, col: 'half', placeholder: '··········' },
            { type: 'select', label: 'Account Type', name: 'accountType', required: true, options: ['Individual Provider', 'Organisation / Company'], col: 'full' }
          ]
        },
        { // STEP 3: Provider Identity & Trust (formerly step 2)
          fields: [
            { type: 'file', label: 'Profile Photo / Logo', name: 'profilePhoto', accept: 'image/*', required: false, col: 'half' },
            { type: 'textarea', label: 'Short Bio (150–250 words)', name: 'bio', placeholder: 'Tell families about your teaching philosophy, experience, and approach...', required: true, col: 'full', rows: 3 },
            { type: 'number', label: 'Years of Experience', name: 'experience', required: true, col: 'half', min: 0, max: 60, placeholder: 'e.g. 8' },
            { type: 'file', label: 'Qualifications / Certifications (PDF or image)', name: 'certs', accept: '.pdf,.doc,.docx,.jpg,.png', required: false, col: 'half' },
            { type: 'file', label: 'Police Clearance (optional)', name: 'clearance', accept: '.pdf,.jpg,.png', required: false, col: 'half' },
            { type: 'multicheck', label: 'Languages Spoken', name: 'languages', options: ['English','Afrikaans','isiZulu','isiXhosa','Sepedi','Setswana','Sesotho','Xitsonga','SiSwati','Tshivenda','isiNdebele','Other'], required: false, col: 'full' }
          ]
        },
        { // STEP 4: Services Offered (formerly step 3) - Delivery Mode now radio group
          fields: [
            { type: 'select', label: 'Primary Category', name: 'primaryCat', required: true, options: ['Tutor','Therapist','Curriculum Provider','Online / Hybrid School','Educational Consultant','Extracurricular / Enrichment'], col: 'half' },
            { type: 'multicheck', label: 'Secondary Categories', name: 'secondaryCats', options: ['Tutor','Therapist','Curriculum','School','Consultant','Enrichment'], required: false, col: 'half' },
            { type: 'text', label: 'Service Title', name: 'serviceTitle', required: true, col: 'full', placeholder: 'e.g. Mathematics Tutor for Grades 10–12' },
            { type: 'textarea', label: 'Service Description', name: 'serviceDesc', required: true, col: 'full', rows: 2, placeholder: 'Describe what you offer, your methods, and what makes you unique...' },
            { type: 'text', label: 'Subjects / Specialisations', name: 'subjects', placeholder: 'e.g. Mathematics, Phonics, OT, ADHD support', required: true, col: 'half' },
            { type: 'multicheck', label: 'Age Groups Served', name: 'ageGroups', options: ['5–7','8–10','11–13','14–18'], required: true, col: 'half' },
            { type: 'radio-group', label: 'Delivery Mode', name: 'deliveryMode', options: ['Online', 'In-person', 'Hybrid (Online & In-person)'], required: true, col: 'full' }
          ]
        },
        { // STEP 5: Location & Reach (formerly step 4)
          fields: [
            { type: 'text', label: 'City', name: 'city', required: true, col: 'half', placeholder: 'e.g. Cape Town' },
            { type: 'select', label: 'Province', name: 'province', required: true, options: ['Eastern Cape','Free State','Gauteng','KwaZulu-Natal','Limpopo','Mpumalanga','Northern Cape','North West','Western Cape'], col: 'half' },
            { type: 'radio-group', label: 'Service Area', name: 'serviceArea', options: ['Local (X km)','National','Online only'], required: true, col: 'full' },
            { type: 'conditional-text', label: 'If local, specify radius (e.g. 30 km)', name: 'localRadius', placeholder: 'e.g. 30 km', required: false, col: 'half', dependsOn: 'serviceArea', dependsValue: 'Local (X km)' }
          ]
        },
        { // STEP 6: Pricing & Availability (formerly step 5)
          fields: [
            { type: 'select', label: 'Pricing Model', name: 'pricingModel', options: ['Hourly','Per package','Per term','Custom quote'], required: true, col: 'half' },
            { type: 'text', label: 'Starting Price (optional, e.g. R280/hr)', name: 'startingPrice', required: false, col: 'half', placeholder: 'e.g. R350/session' },
            { type: 'multicheck', label: 'Days available', name: 'daysAvailable', options: ['Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sunday'], required: true, col: 'full' },
            { type: 'text', label: 'Time slots', name: 'timeSlots', placeholder: 'e.g. 9:00–14:00, 15:30–17:30 (24h format recommended)', required: true, col: 'full' }
          ]
        },
        { // STEP 7: Contact & Online Presence (formerly step 6) - NOW FINAL STEP WITH SUBMIT and SA phone formatting
          fields: [
            { type: 'tel', label: 'Phone Number', name: 'phone', required: true, col: 'half', placeholder: '+27 71 234 5678' },
            { type: 'tel', label: 'WhatsApp Number', name: 'whatsapp', required: false, col: 'half', placeholder: '+27 71 234 5678' },
            { type: 'email', label: 'Email for inquiries', name: 'inquiryEmail', required: true, col: 'full', placeholder: 'contact@example.com' },
            { type: 'url', label: 'Website', name: 'website', required: false, col: 'half', placeholder: 'https://yourwebsite.co.za' },
            { type: 'url', label: 'Facebook', name: 'facebook', placeholder: 'https://facebook.com/yourpage', required: false, col: 'half' },
            { type: 'url', label: 'Twitter', name: 'twitter', placeholder: 'https://twitter.com/yourhandle', required: false, col: 'half' },
            { type: 'url', label: 'Instagram', name: 'instagram', placeholder: 'https://instagram.com/yourprofile', required: false, col: 'half' },
            { type: 'url', label: 'LinkedIn', name: 'linkedin', placeholder: 'https://linkedin.com/in/yourname', required: false, col: 'half' },
            { type: 'url', label: 'Pinterest', name: 'pinterest', placeholder: 'https://pinterest.com/yourprofile', required: false, col: 'half' },
            { type: 'url', label: 'TikTok', name: 'tiktok', placeholder: 'https://tiktok.com/@yourhandle', required: false, col: 'half' }
          ]
        }
      ];

      let currentStep = 1;
      const totalSteps = steps.length; // now 7 steps
      let formData = {};

      const stepContainer = document.getElementById('stepContainer');
      const formNav = document.getElementById('formNav');
      const validationAlert = document.getElementById('validationAlert');
      const alertMsg = document.getElementById('alertMsg');
      const stepCounter = document.getElementById('stepCounter');
      const progressFill = document.getElementById('stepProgressFill');

      function setupTypingClear() {
        document.querySelectorAll('#activeStepGrid input, #activeStepGrid select, #activeStepGrid textarea').forEach(el => {
          el.addEventListener('input', () => { validationAlert.style.display = 'none'; });
          el.addEventListener('change', () => { validationAlert.style.display = 'none'; });
        });
      }

      function attachPasswordToggle() {
        document.querySelectorAll('.toggle-pw').forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.preventDefault();
            const input = btn.parentElement.querySelector('input');
            const type = input.getAttribute('type') === 'password' ? 'text' : 'password';
            input.setAttribute('type', type);
            btn.innerHTML = type === 'password' ? '<i class="far fa-eye"></i>' : '<i class="far fa-eye-slash"></i>';
          });
        });
      }

      function attachOtherLanguageHandler() {
        const otherCheck = document.querySelector('input[name="languages"][value="Other"]');
        if (!otherCheck) return;
        const container = otherCheck.closest('.checkbox-group');
        let otherInputDiv = document.getElementById('otherLangInput');
        if (!otherInputDiv) {
          otherInputDiv = document.createElement('div');
          otherInputDiv.id = 'otherLangInput';
          otherInputDiv.className = 'other-language-row full-width';
          otherInputDiv.style.display = 'none';
          otherInputDiv.innerHTML = '<input type="text" placeholder="Specify other language" id="otherLangField">';
          container.parentElement.appendChild(otherInputDiv);
        }
        const otherTextField = document.getElementById('otherLangField');
        function toggleOther() {
          if (otherCheck.checked) {
            otherInputDiv.style.display = 'flex';
          } else {
            otherInputDiv.style.display = 'none';
            if (otherTextField) otherTextField.value = '';
          }
        }
        otherCheck.addEventListener('change', toggleOther);
        toggleOther();
        if (otherTextField) {
          otherTextField.addEventListener('input', () => {
            formData.otherLanguage = otherTextField.value;
          });
        }
      }

      function attachConditionalHandler() {
        const radios = document.querySelectorAll('input[name="serviceArea"]');
        const localField = document.querySelector('.field.conditional-radius');
        if (!radios.length || !localField) return;
        function toggleLocal() {
          const selected = Array.from(radios).find(r => r.checked)?.value;
          if (selected === 'Local (X km)') {
            localField.style.display = 'flex';
          } else {
            localField.style.display = 'none';
            const input = localField.querySelector('input');
            if (input) input.value = '';
          }
        }
        radios.forEach(r => r.addEventListener('change', toggleLocal));
        toggleLocal();
      }

      // Phone number formatting for South African numbers
      function formatPhoneNumber(input) {
        if (!input) return;
        let value = input.value.replace(/\D/g, '');
        
        // If user starts typing 0, replace with +27
        if (value.startsWith('0')) {
          value = '27' + value.substring(1);
        }
        
        // Format as +27 XX XXX XXXX
        if (value.length >= 2) {
          let formatted = '+' + value.substring(0, 2);
          if (value.length > 2) {
            formatted += ' ' + value.substring(2, 4);
          }
          if (value.length > 4) {
            formatted += ' ' + value.substring(4, 7);
          }
          if (value.length > 7) {
            formatted += ' ' + value.substring(7, 11);
          }
          input.value = formatted;
        } else if (value.length > 0) {
          input.value = '+' + value;
        }
      }

      function attachPhoneFormatter() {
        const phoneInput = document.getElementById('phone');
        const whatsappInput = document.getElementById('whatsapp');
        
        if (phoneInput) {
          phoneInput.addEventListener('input', function(e) {
            formatPhoneNumber(this);
          });
        }
        
        if (whatsappInput) {
          whatsappInput.addEventListener('input', function(e) {
            formatPhoneNumber(this);
          });
        }
      }

      function getStepTitle(step) { 
        const titles = [
          'Choose Your Listing Plan',
          'Account Setup',
          'Provider Identity & Trust',
          'Services Offered',
          'Location & Reach',
          'Pricing & Availability',
          'Contact & Online Presence'
        ];
        return titles[step-1]; 
      }
      
      function getStepDesc(step) { 
        const desc = [
          'Select a plan and agree to terms',
          'Create your provider account',
          'Build trust with qualifications',
          'Tell families what you offer',
          'Where can you serve families?',
          'Set your rates and schedule',
          'How families can reach you (final step)'
        ];
        return desc[step-1]; 
      }
      
      function getIcon(type) { return 'edit'; }

      function renderStep(step) {
        const stepDef = steps[step-1];
        let html = `<div class="step-title">Step ${step}: ${getStepTitle(step)}</div>
                    <div class="step-desc">${getStepDesc(step)}</div>`;
        html += `<div id="validationAlertPlaceholder"></div>`;
        html += `<div class="form-grid" id="activeStepGrid">`;

        stepDef.fields.forEach(f => {
          const colClass = f.col === 'full' ? 'full-width' : '';
          let extraClass = '';
          if (f.type === 'conditional-text') extraClass = 'conditional-radius';
          html += `<div class="field ${colClass} ${extraClass}" data-field="${f.name}" style="${f.type==='conditional-text' ? 'display:none;' : ''}">`;
          html += `<label><i class="fas fa-${getIcon(f.type)}"></i> ${f.label} ${f.required ? '<span style="color:var(--accent);">*</span>' : ''}</label>`;

          if (f.type === 'select') {
            html += `<select name="${f.name}" ${f.required ? 'required' : ''}>`;
            html += `<option value="">-- Select --</option>`;
            f.options.forEach(opt => {
              const selected = (formData[f.name] === opt) ? 'selected' : '';
              html += `<option value="${opt}" ${selected}>${opt}</option>`;
            });
            html += `</select>`;
          }
          else if (f.type === 'textarea') {
            html += `<textarea name="${f.name}" placeholder="${f.placeholder || ''}" rows="${f.rows || 3}" ${f.required ? 'required' : ''}>${formData[f.name] || ''}</textarea>`;
          }
          else if (f.type === 'file') {
            html += `<input type="file" name="${f.name}" accept="${f.accept || '*'}" ${f.required ? 'required' : ''}>`;
          }
          else if (f.type === 'multicheck') {
            html += `<div class="checkbox-group" id="group-${f.name}">`;
            const savedArr = formData[f.name] || [];
            f.options.forEach(opt => {
              const checked = savedArr.includes(opt) ? 'checked' : '';
              html += `<label><input type="checkbox" name="${f.name}" value="${opt}" ${checked}> ${opt}</label>`;
            });
            html += `</div>`;
          }
          else if (f.type === 'radio-group') {
            html += `<div class="checkbox-group" style="gap:20px;">`;
            f.options.forEach(opt => {
              let checked = (formData[f.name] === opt) ? 'checked' : '';
              if (f.default && !formData[f.name] && opt === f.default) checked = 'checked';
              html += `<label><input type="radio" name="${f.name}" value="${opt}" ${checked} ${f.required ? 'required' : ''}> ${opt}</label>`;
            });
            html += `</div>`;
          }
          else if (f.type === 'terms-check') {
            html += `<div class="terms-checkbox">`;
            const checked = formData[f.name] ? 'checked' : '';
            html += `<input type="checkbox" name="${f.name}" ${checked} ${f.required ? 'required' : ''} id="termsBox">`;
            html += `<label for="termsBox">${f.label} – <a href="#" class="terms-link" onclick="window.open('/terms','_blank'); return false;">Read Terms & Guidelines</a></label>`;
            html += `</div>`;
          }
          else if (f.type === 'password') {
            html += `<div class="password-wrapper">`;
            html += `<input type="password" name="${f.name}" placeholder="${f.placeholder || ''}" value="${formData[f.name] || ''}" ${f.required ? 'required' : ''}>`;
            html += `<button class="toggle-pw" type="button"><i class="far fa-eye"></i></button>`;
            html += `</div>`;
          }
          else if (f.type === 'conditional-text') {
            html += `<input type="text" name="${f.name}" placeholder="${f.placeholder || ''}" value="${formData[f.name] || ''}">`;
          }
          else {
            html += `<input type="${f.type}" name="${f.name}" placeholder="${f.placeholder || ''}" value="${formData[f.name] || ''}" ${f.required ? 'required' : ''}>`;
          }
          html += `</div>`;
        });
        html += `</div>`;
        stepContainer.innerHTML = html;

        const placeholder = document.getElementById('validationAlertPlaceholder');
        if (placeholder) {
          placeholder.parentNode.insertBefore(validationAlert, placeholder.nextSibling);
          placeholder.remove();
        }

        attachPasswordToggle();
        if (step === 3) attachOtherLanguageHandler(); // Languages on step 3
        if (step === 5) attachConditionalHandler(); // Conditional radius on step 5
        if (step === 7) attachPhoneFormatter(); // Phone formatting on final step
        setupTypingClear();
      }

      function saveCurrentStepData() {
        const stepDef = steps[currentStep-1];
        stepDef.fields.forEach(f => {
          if (f.type === 'multicheck') {
            const checked = Array.from(document.querySelectorAll(`input[name="${f.name}"]:checked`)).map(c => c.value);
            formData[f.name] = checked;
          } else if (f.type === 'terms-check' || (f.type === 'checkbox' && !f.options)) {
            const el = document.querySelector(`[name="${f.name}"]`);
            if (el) formData[f.name] = el.checked;
          } else if (f.type === 'conditional-text') {
            const el = document.querySelector(`[name="${f.name}"]`);
            if (el) formData[f.name] = el.value;
          } else {
            const el = document.querySelector(`[name="${f.name}"]`);
            if (el && el.type !== 'file') formData[f.name] = el.value;
            else if (el && el.type === 'file' && el.files.length) formData[f.name] = el.files[0].name;
          }
        });
        if (currentStep === 3 && document.getElementById('otherLangField')) {
          formData.otherLanguage = document.getElementById('otherLangField').value;
        }
      }

      function validateStep(step) {
        const stepDef = steps[step-1];
        for (let f of stepDef.fields) {
          if (!f.required) continue;
          
          // Special validation for time slots (step 6)
          if (f.name === 'timeSlots' && f.required) {
            const val = formData[f.name];
            if (!val || val.trim() === '') return f.label;
            // Basic time format validation (e.g., "9:00–14:00" or "09:00-17:00")
            const timePattern = /^(\d{1,2}:\d{2})\s*[-–]\s*(\d{1,2}:\d{2})(\s*,\s*(\d{1,2}:\d{2})\s*[-–]\s*(\d{1,2}:\d{2}))*$/;
            if (!timePattern.test(val.trim())) {
              return 'time slots in format like 9:00–14:00, 15:30–17:30';
            }
            continue;
          }
          
          // Special validation for SA phone numbers (step 7)
          if (f.name === 'phone' && f.required) {
            const val = formData[f.name];
            if (!val || val.trim() === '') return f.label;
            // SA phone number validation: +27 followed by 9 digits (with optional spaces)
            const saPhonePattern = /^\+27\s?[1-9]\d{1}\s?\d{3}\s?\d{4}$|^\+27[1-9]\d{8}$/;
            const cleaned = val.replace(/\s/g, '');
            if (!saPhonePattern.test(cleaned)) {
              return 'valid SA phone number starting with +27 (e.g., +27 71 234 5678)';
            }
            continue;
          }
          
          if (f.type === 'multicheck') {
            const checked = formData[f.name] || [];
            if (checked.length === 0) return f.label;
          } else if (f.type === 'terms-check' || f.type === 'checkbox') {
            if (!formData[f.name]) return f.label;
          } else if (f.type === 'radio-group') {
            if (!formData[f.name] || formData[f.name].trim() === '') return f.label;
          } else if (f.type === 'email') {
            const val = formData[f.name];
            if (!val || !/^\S+@\S+\.\S+$/.test(val)) return 'valid email';
          } else {
            const val = formData[f.name];
            if (!val || val.toString().trim() === '') return f.label;
          }
        }
        return null;
      }

      function nextStep() {
        saveCurrentStepData();
        const invalid = validateStep(currentStep);
        if (invalid) {
          alertMsg.innerText = `Please complete required field: ${invalid}`;
          validationAlert.style.display = 'flex';
          document.querySelector('.step-title').scrollIntoView({ behavior: 'smooth', block: 'start' });
          return;
        }
        validationAlert.style.display = 'none';
        if (currentStep < totalSteps) {
          currentStep++;
          updateStepDisplay();
        } else {
          finalSubmit();
        }
      }

      function prevStep() {
        saveCurrentStepData();
        validationAlert.style.display = 'none';
        if (currentStep > 1) {
          currentStep--;
          updateStepDisplay();
        }
      }

      function updateStepDisplay() {
        renderStep(currentStep);
        stepCounter.innerText = `Step ${currentStep} / ${totalSteps}`;
        progressFill.style.width = (currentStep / totalSteps * 100) + '%';
        let navHtml = '';
        if (currentStep > 1) navHtml += `<button class="btn-prev" id="prevBtn"><i class="fas fa-arrow-left"></i> Previous</button>`;
        else navHtml += `<div></div>`;
        if (currentStep < totalSteps) {
          navHtml += `<button class="btn-next" id="nextBtn">Next <i class="fas fa-arrow-right"></i></button>`;
        } else {
          navHtml += `<button class="btn-submit" id="submitBtn"><i class="fas fa-check-circle"></i> Create My Profile</button>`;
        }
        formNav.innerHTML = navHtml;
        document.getElementById('prevBtn')?.addEventListener('click', prevStep);
        document.getElementById('nextBtn')?.addEventListener('click', nextStep);
        document.getElementById('submitBtn')?.addEventListener('click', nextStep);
      }

      function finalSubmit() {
        saveCurrentStepData();
        const invalid = validateStep(currentStep);
        if (invalid) {
          alertMsg.innerText = `Please complete required field: ${invalid}`;
          validationAlert.style.display = 'flex';
          document.querySelector('.step-title').scrollIntoView({ behavior: 'smooth', block: 'start' });
          return;
        }
        showToast('Profile created successfully! Redirecting to your dashboard...');
        // Redirect to client dashboard as requested
        setTimeout(() => window.location.href = 'dashboards/client-dashboard.html', 1500);
      }

      function showToast(msg) {
        const t = document.getElementById('toast');
        document.getElementById('toastMsg').textContent = msg;
        t.classList.add('show');
        setTimeout(() => t.classList.remove('show'), 3500);
      }

      updateStepDisplay();
    })();
  </script>
</body>
</html>